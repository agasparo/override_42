<!DOCTYPE html>
<html>
<head>
	<title>Level09</title>
	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="css/style.css">
</head>
<body>
	<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
		<a class="navbar-brand" href="#">Level09</a>
		<ul class="navbar-nav mr-auto">
			<li class="nav-item">
        		<a class="nav-link" href="../../manuel.html">retour</a>
      		</li>
		</ul>
	</nav>
	<div align="center">
		<h1 class="mt-4">Level09</h1>

		<div class="mt-5">
			<h5 class="mt-4">Etape 1 : </h5>
			<p class="lead">on lance le progammme</p>
			<img src="img/etape1.png" class="mt-4 om">
		</div>

		<div class="mt-5">
			<h5 class="mt-4">Etape 2 : </h5>
			<p class="lead">on lance gdb</p>
			<p class="lead">on comprend que le programme a une structure</p>
			<p class="lead">on peut voir set_msg() avec un strncpy mais qui est proteger</p>
			<p class="lead">on peut voir set_username() qui a une boucle de 0 a 40 qui fait 41 alors que username est un char[40]</p>
			<p class="lead">on peut voir une fonction secret_backdoor</p>
			<img src="img/etape2.png" class="mt-4 om">
		</div>

		<div class="mt-5">
			<h5 class="mt-4">Etape 3 : </h5>
			<p class="lead">on le disas et on peut voir une fonction system</p>
			<img src="img/etape3.png" class="mt-4 om">
		</div>

		<div class="mt-5">
			<h5 class="mt-4">Etape 4 : </h5>
			<p class="lead">on fait segfault le progamme</p>
			<p class="lead">payload : 40 bytes pour username + 1 byte pour overwite(xff de pref car cest le plus grand possible : 255) + \n + string to segfault</p>
			<p class="lead">on trouve l'offset : 192</p>
			<img src="img/etape4.png" class="mt-4 om">
		</div>

		<div class="mt-5">
			<h5 class="mt-4">Etape 5 : </h5>
			<p class="lead">on recuperer l'adresse de la fonction backdoor qui est : 0x000055555555488c</p>
			<p class="lead">payload = 40 bytes + 1 byte + \n + 200 byte(offste + 8) + addr + \n + bin/sh + \n</p>
			<img src="img/etape5.png" class="mt-4 om">
		</div>
		<br><br>
		<h1 class="mt-4">Level09 programme</h1>

		<div class="mt-5">
			<h5 class="mt-4">Etape 1 : </h5>
			<img src="img/etape2.png" class="mt-4 om">
		</div>

		<div class="mt-5">
			<h5 class="mt-4">Etape 2 : </h5>
			<img src="img/pr2.png" class="mt-4 om">
		</div>
		</div>
	</div>
	<br><br><br>
</body>
</html>